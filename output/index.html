<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Output - seabreeze</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">seabreeze</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../installation/" class="nav-link">Installation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../usage/" class="nav-link">Usage</a>
                            </li>
                            <li class="nav-item">
                                <a href="./" class="nav-link active" aria-current="page">Output</a>
                            </li>
                            <li class="nav-item">
                                <a href="../tutorial/" class="nav-link">Tutorial</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../usage/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../tutorial/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#output" class="nav-link">Output</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#analyse-genome-sizes" class="nav-link">Analyse genome sizes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#predict-svs" class="nav-link">Predict SVs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#annotate-genes-in-svs" class="nav-link">Annotate genes in SVs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#predict-sv-mechanism" class="nav-link">Predict SV mechanism</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="output">Output</h1>
<h2 id="analyse-genome-sizes">Analyse genome sizes</h2>
<p>This command generates <code>data/04_rename_genome/genome_size_stats.csv</code> as output. This csv file has the following fields:</p>
<ul>
<li>assembly: name of the assembly, as specified in <code>data/data.csv</code></li>
<li>ancestor: name of the ancestor, as specified in <code>data/data.csv</code></li>
<li>size_assembly: size of the assembly, in bp</li>
<li>size_ancestor: size of the ancestor, in bp</li>
<li>difference: size_assembly - size_ancestor. This value is negative when the ancestor is larger than the assembly</li>
<li>percent_change: the difference in size, as a percent of the size of the assembly </li>
</ul>
<p>See a sample table in the <a href="../tutorial/">tutorial</a>.</p>
<h2 id="predict-svs">Predict SVs</h2>
<p><a href="https://github.com/mummer4/mummer">mummer4</a> is used to perform alignments between assembly-ancestor pairs. The alignment files are stored in <code>data/06_nucmer_alignment/&lt;assembly&gt;/</code> directories. Each of these directories contains the following files:</p>
<ul>
<li><code>&lt;assembly&gt;.delta</code>: The all-vs-all alignment generated by the <code>nucmer</code> command of <em>mummer4</em> </li>
<li><code>&lt;assembly&gt;.delta.filter</code>: The <code>&lt;assembly&gt;.delta</code> file is filtered by the <code>delta-filter</code> command to only retain alignments &gt; 95% sequence identity and &gt; 100bp long.</li>
<li><code>&lt;assembly&gt;.filtered.coords</code>: A file summarising information about each delta alignment in the filtered file.</li>
</ul>
<p>For specific information about these file formats, please refer to the <a href="https://mummer.sourceforge.net/manual/#coords">mummer manual</a>. </p>
<p>Next <a href="https://github.com/schneebergerlab/syri">SyRI</a> is used to call SVs using those alignments. The output files for each assembly is in the respective <code>data/07_syri_output/&lt;assembly&gt;/</code> directories. Each of these directories contains the following files:</p>
<ul>
<li><code>&lt;assembly&gt;syri.out</code>: a tsv file that describes the location and type of SVs in the assembly, relative to its ancestor. We refer the user to the official <a href="https://schneebergerlab.github.io/syri/fileformat.html">SyRI documentation</a> for information on interpreting this table. You may notice that the reference and query chromosome ID  read as "genome". This is because SyRI attempts to call variants between homologous chromosomes, and hence expects the reference and query ID to be the same string. To prevent this error from occurring, the genomes are renamed to a placeholder string 'genome'. You may also see that for a deletion, the query start and stop site are the same. You can also find a sample table in the <a href="../tutorial/">tutorial</a>. </li>
<li><code>&lt;assembly&gt;syri.vcf</code>: a variant calling format (vcf) file describing the same SVs</li>
</ul>
<p>Raw output generated by <a href="https://github.com/schneebergerlab/syri">SyRI</a> was refined with custom python scripts to predict a minimal set of structural variants. Briefly, new insertions of individual IS elements due to transposition events were filtered out, ambiguous nomenclature for deletions was replaced with consistent terminology, falsely classified duplications were corrected, adjacent deletions were merged, and adjacent syntenic regions were merged. This filtered set of SVs is a tsv file <code>data/07_syri_output/&lt;assembly&gt;/&lt;assembly&gt;_clean.syri.out</code> and follows the same file format as <code>&lt;assembly&gt;syri.out</code>. </p>
<p>Finally, a modified version of <a href="https://github.com/ira-zibbu/plotsr">plotsr</a> is used to generate synteny plots. Two synteny plots are generated in <code>data/07_syri_output/&lt;assembly&gt;/</code>:</p>
<ul>
<li><code>&lt;assembly&gt;.plot.pdf</code>: synteny plot corresponding to the SVs in <code>&lt;assembly&gt;syri.out</code></li>
<li><code>&lt;assembly&gt;.plot.2.pdf</code>: synteny plot corresponding to SVs in <code>&lt;assembly&gt;_clean.syri.out</code></li>
</ul>
<blockquote>
<p>Tip: The 4th and 5th columns of the <code>&lt;assembly&gt;_clean.syri.out</code> file have the reference/query sequences for indels. For large deletions, these field can have thousands of bases. To view this tsv file in the terminal without these columns, try running</p>
</blockquote>
<pre><code>cat &lt;assembly&gt;_clean.syri.out | cut --complement -f 4-5
</code></pre>
<p>Note: SyRI sometimes fails to correctly identify copy number variation (deletions and amplifications) or more complex rearrangements (such as overlapping inversions).</p>
<h2 id="annotate-genes-in-svs">Annotate genes in SVs</h2>
<p>This command uses <a href="https://github.com/tseemann/prokka">prokka</a> annotate the assemblies and generates GFF files for each in <code>data/09_annotated_genomes/&lt;assembly&gt;/&lt;assembly&gt;.gff</code>.</p>
<p>Next, <a href="https://github.com/barricklab/breseq">breseq</a> uses these GFF files to annotate the genes present in the deletions, inversions and amplifications. This step produces two outputs for each assembly:
- <code>data/12_genome_diff_tables/gd/&lt;assembly&gt;.gd</code>: This is a GenomeDiff format that is a tsv file describing the locations, size and types of SVs. Please see the <a href="https://gensoft.pasteur.fr/docs/breseq/0.35.0/gd_format.html">breseq</a> documentation for more information about this file format. 
- <code>data/12_genome_diff_tables/html/&lt;assembly&gt;.html</code>: This is an html, human-readable version of the GenomeDiff file that contains the names of the genes contained in the SV regions. For an example of this table, please see the <a href="../tutorial/">tutorial</a>. For information about the columns in this table, please see the <a href="https://gensoft.pasteur.fr/docs/breseq/0.35.0/output.html#html-human-readable-output">breseq</a> documentation. </p>
<h2 id="predict-sv-mechanism">Predict SV mechanism</h2>
<p>This command annotates the insertion sequences at the boundaries of structural variants (for deletions and inversions only) and predicts putative mechanisms. All of the output from this step is in the directory <code>data/11_annotated_boundaries/</code>. Each assembly has three files associated with it:</p>
<ol>
<li>
<p><code>data/11_annotated_boundaries/&lt;assembly&gt;_boundaries.csv</code>: This csv file annotates insertion sequences that are within a threshold distance of the start and end sites of a structural variant. The threshold has arbitrarily been set to 20bp. This csv file has the following columns:</p>
</li>
<li>
<p><code>ref_start</code>: Start site of the SV in the ancestor</p>
</li>
<li><code>ref_stop</code>: Stop site of the SV in the ancestor</li>
<li><code>query_start</code>: Start site of the SV in the assembly</li>
<li><code>query_stop</code>: Stop site of the SV in the aseembly</li>
<li><code>tag_3</code>: Type of SV. This follows the <a href="https://schneebergerlab.github.io/syri/fileformat.html">SyRI</a> nomenclature (SYN: syntenic region, INV: inversion, DUP: duplication, TRANS: translocation, DEL: deletion)</li>
<li><code>L_ref</code>: Name of insertion sequence within threshold distance of the start site of the SV in the ancestor. This is 'NA' if none is found.</li>
<li><code>L_ref_distance</code>: Distance of the closest end of the insertion sequence from the start site of the SV in the ancestor.</li>
<li><code>R_ref</code>:  Name of insertion sequence within threshold distance of the stop site of the SV in the ancestor. This is 'NA' if none is found.</li>
<li><code>R_ref_distance</code>: Distance of the closest end of the insertion sequence from the start site of the SV in the ancestor.</li>
<li><code>L_query</code>:  Name of insertion sequence within threshold distance of the start site of the SV in the assembly. This is 'NA' if none is found.</li>
<li><code>L_query_distance</code>: Distance of the closest end of the insertion sequence from the start site of the SV in the assembly.</li>
<li><code>R_query</code>: Name of insertion sequence within threshold distance of the stop site of the SV in the assembly. This is 'NA' if none is found.</li>
<li><code>R_query_distance</code>: Distance of the closest end of the insertion sequence from the start site of the SV in the assembly.</li>
</ol>
<p>Note: For deletions, the <code>query_start</code> and <code>query_stop</code> coordinates will be of the same length. Additionally, the distances can be positive or negative, depending on if the insertion sequence starts/ends before or after that edge of the SV.</p>
<ol>
<li>
<p><code>data/11_annotated_boundaries/&lt;assembly&gt;_deletion.csv</code>: This file contains the same fields as (1), with two additional columns. These columns describe the various configurations in which insertion sequences can flank an SV.</p>
</li>
<li>
<p><code>Mechanism</code>: This field can take on values of 'between_IS', 'IS_mediated' and 'Other'</p>
</li>
<li><code>Evidence</code>: This field can take on values of 'full', 'evolved', 'incomplete' or 'NA'. </li>
</ol></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
